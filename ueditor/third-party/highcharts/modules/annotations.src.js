(function(t,i){var e,n,a,r=t.Chart,s=t.extend,o=t.each;a=["path","rect","circle"],n={top:0,left:0,center:.5,middle:.5,bottom:1,right:1};var l=i.inArray,h=t.merge;function p(t){var i,e;return e={xAxis:0,yAxis:0,title:{style:{},text:"",x:0,y:0},shape:{params:{stroke:"#000000",fill:"transparent",strokeWidth:2}}},i={circle:{params:{x:0,y:0}}},i[t]&&(e.shape=h(e.shape,i[t])),e}function c(t){return"[object Array]"===Object.prototype.toString.call(t)}function u(t){return"number"===typeof t}function d(t){return t!==e&&null!==t}function y(t,i,e,n,a){var r=t.length,s=0;while(s<r)"number"===typeof t[s]&&"number"===typeof t[s+1]?(t[s]=i.toPixels(t[s])-n,t[s+1]=e.toPixels(t[s+1])-a,s+=2):s+=1;return t}var f=function(){this.init.apply(this,arguments)};f.prototype={init:function(t,i){var e=i.shape&&i.shape.type;this.chart=t,this.options=h({},p(e),i)},render:function(t){var i=this,e=this.chart,n=i.chart.renderer,r=i.group,s=i.title,o=i.shape,h=i.options,p=h.title,c=h.shape;r||(r=i.group=n.g()),!o&&c&&-1!==l(c.type,a)&&(o=i.shape=n[h.shape.type](c.params),o.add(r)),!s&&p&&(s=i.title=n.label(p),s.add(r)),r.add(e.annotations.group),i.linkObjects(),!1!==t&&i.redraw()},redraw:function(){var i,e,a,r,o,h,p,c=this.options,f=this.chart,x=this.group,g=this.title,b=this.shape,m=this.linkedObject,v=f.xAxis[c.xAxis],w=f.yAxis[c.yAxis],k=c.width,P=c.height,O=n[c.anchorY],j=n[c.anchorX];if(m&&(e=m instanceof t.Point?"point":m instanceof t.Series?"series":null,"point"===e?(c.xValue=m.x,c.yValue=m.y,a=m.series):"series"===e&&(a=m),x.visibility!==a.group.visibility&&x.attr({visibility:a.group.visibility})),h=d(c.xValue)?v.toPixels(c.xValue+v.minPointOffset)-v.minPixelPadding:c.x,p=d(c.yValue)?w.toPixels(c.yValue):c.y,!isNaN(h)&&!isNaN(p)&&u(h)&&u(p)){if(g&&(g.attr(c.title),g.css(c.title.style),!0),b){if(i=s({},c.shape.params),"values"===c.units){for(r in i)l(r,["width","x"])>-1?i[r]=v.translate(i[r]):l(r,["height","y"])>-1&&(i[r]=w.translate(i[r]));i.width&&(i.width-=v.toPixels(0)-v.left),i.x&&(i.x+=v.minPixelPadding),"path"===c.shape.type&&y(i.d,v,w,h,p)}"circle"===c.shape.type&&(i.x+=i.r,i.y+=i.r),!0,b.attr(i)}x.bBox=null,u(k)||(o=x.getBBox(),k=o.width),u(P)||(o||(o=x.getBBox()),P=o.height),u(j)||(j=n.center),u(O)||(O=n.center),h-=k*j,p-=P*O,f.animation&&d(x.translateX)&&d(x.translateY)?x.animate({translateX:h,translateY:p}):x.translate(h,p)}},destroy:function(){var t=this,i=this.chart,e=i.annotations.allItems,n=e.indexOf(t);n>-1&&e.splice(n,1),o(["title","shape","group"],(function(i){t[i]&&(t[i].destroy(),t[i]=null)})),t.group=t.title=t.shape=t.chart=t.options=null},update:function(t,i){s(this.options,t),this.linkObjects(),this.render(i)},linkObjects:function(){var t=this,i=t.chart,e=t.linkedObject,n=e&&(e.id||e.options.id),a=t.options,r=a.linkedTo;d(r)?d(e)&&r===n||(t.linkedObject=i.get(r)):t.linkedObject=null}},s(r.prototype,{annotations:{add:function(t,i){var e,n,a=this.allItems,r=this.chart;c(t)||(t=[t]),n=t.length;while(n--)e=new f(r,t[n]),a.push(e),e.render(i)},redraw:function(){o(this.allItems,(function(t){t.redraw()}))}}}),r.prototype.callbacks.push((function(i){var e,n=i.options.annotations;e=i.renderer.g("annotations"),e.attr({zIndex:7}),e.add(),i.annotations.allItems=[],i.annotations.chart=i,i.annotations.group=e,c(n)&&n.length>0&&i.annotations.add(i.options.annotations),t.addEvent(i,"redraw",(function(){i.annotations.redraw()}))}))})(Highcharts,HighchartsAdapter);